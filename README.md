# luci-podkop-subscribe

![luci-podkop-subscribe](img.png)

Расширение LuCI для Podkop, добавляющее функциональность Subscribe URL для получения и управления конфигурациями прокси VLESS.

## Описание

Этот плагин расширяет интерфейс LuCI Podkop функцией Subscribe, которая позволяет пользователям:

- Вводить Subscribe URL, содержащий конфигурации VLESS в формате base64
- Получать конфигурации из Subscribe URL одним нажатием кнопки
- Просматривать доступные конфигурации в удобном списке
- Выбирать и применять конфигурации напрямую к настройкам прокси
- Автоматически сохранять и восстанавливать Subscribe URL при перезагрузке страницы

## Возможности

- **Поле Subscribe URL**: Поле ввода для ввода ссылок подписки
- **Получить конфигурации**: Кнопка для получения и парсинга конфигураций VLESS
- **Список конфигураций**: Отображает доступные конфигурации с их названиями
- **Выбор одним кликом**: Клик по конфигурации применяет её к настройкам прокси
- **Автосохранение**: Subscribe URL автоматически сохраняется и восстанавливается
- **Умная видимость**: Список конфигураций появляется только когда Тип подключения установлен в "Proxy" и Тип конфигурации в "Connection URL"

## Требования

- OpenWrt 24.x или новее
- luci-app-podkop (Podkop должен быть установлен)
- wget
- base64 (обычно включен в BusyBox)

## Протестировано на

- **Podkop**: v0.7.9 - v0.7.10
- **LuCI App**: v0.7.9 - v0.7.10
- **OpenWrt**: 24.10.4

## Установка

### Быстрая установка

```bash
sh <(wget -O - https://raw.githubusercontent.com/mr-Abdrahimov/luci-podkop-subscribe/main/install.sh)
```

## Как это работает

1. Пользователь вводит Subscribe URL в поле "Subscribe URL"
2. Нажимает кнопку "Получить"
3. Плагин получает содержимое URL (ожидается данные в формате base64)
4. Декодирует данные base64 и парсит URL VLESS
5. Отображает конфигурации в списке ниже поля Subscribe URL
6. Пользователь кликает по конфигурации для применения её к настройкам прокси
7. Subscribe URL автоматически сохраняется для будущего использования

## Технические детали

- **Frontend**: JavaScript расширение для представления секции Podkop
- **Backend**: Два CGI скрипта:
  - `/cgi-bin/podkop-subscribe`: Получает и парсит данные подписки
  - `/cgi-bin/podkop-subscribe-url`: Управляет хранением Subscribe URL
- **Хранилище**: Subscribe URL сохраняется в `/tmp/podkop_subscribe_url.txt`

## Важные примечания

- Этот плагин модифицирует файл `section.js` Podkop
- Повторная установка плагина полностью заменит модифицированный файл
- Podkop и его зависимости **никогда** не удаляются при удалении плагина

## Лицензия

GPL-2.0

## Репозиторий

https://github.com/mr-Abdrahimov/luci-podkop-subscribe

## Автор

mr-Abdrahimov
